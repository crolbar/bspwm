
;volume
(defpoll monvolume :interval "555h" :initial 0 `scripts/volume mon poll`)
(defpoll headvolume :interval "555h" :initial 0 `scripts/volume head poll`)
(defpoll micvolume :interval "555h" :initial 0 `scripts/volume mic poll`)
(defpoll musicvolume :interval "555h" :initial 0 `scripts/volume music poll`)
(defpoll browservolume :interval "555h" :initial 0 `scripts/volume browser poll`)
;notes
(defpoll notes :interval "555h" "cat ~/.notes.txt")
;time
(defpoll time :interval "10s" "date '+%I:%M %p %A %d.%m.%y'")
;weather
(defpoll weatherIcon :interval "555h" `python scripts/weather.py icon`)
(defpoll weatherIconColor :interval "555h" `python scripts/weather.py icon-color`)
(defpoll weatherTemp :interval "555h" `python scripts/weather.py temp`)
(defpoll weatherStat :interval "555h" `python scripts/weather.py status`)
(defpoll weatherWind :interval "555h" `python scripts/weather.py wind`)
;network
(defpoll upSpeed :interval "1s" `eww get EWW_NET | jq '.eno1.NET_UP' | awk '{ printf "%.2f MiB/s", $1 / 1024 / 1024 / 2 }'`)
(defpoll downSpeed :interval "1s" `eww get EWW_NET | jq '.eno1.NET_DOWN' | awk '{ printf "%.2f MiB/s", $1 / 1024 / 1024 / 2 }'`)





(defwidget board []
    (box :class "board-box" :orientation "v"
        (box :class "top" :orientation "h" :halign "center" :space-evenly false
            (button :class "power-menu-button" :tooltip "open power-menu" :onclick "eww open power-menu --toggle" "")
            (button :class "wofi" :onclick "wofi --conf ~/.config/hypr/wofi/config --style ~/.config/hypr/wofi/style.css &" "{  }") 
            (label :text time :class "time")
            (button :class "reload-button" :onclick "eww reload" "")
            (button :class "close-button" :onclick "eww close board" "")
        )
        (box :class "cal-notes" :orientation "h" 
            (box :class "cal" (cal))
            (box :class "notes" :orientation "v" :space-evenly false :halign "center"
            (label :text notes :limit-width 75 :wrap true)
            (box :orientation "h"
                (button :class "edit-button" :onclick "alacritty -e nvim ~/.notes.txt & sleep 0.1 && hyprctl dispatch togglefloating && hyprctl dispatch centerwindow" "edit")
                (button :class "clear-button" :onclick "echo '' > ~/.notes.txt && eww reload" "clear")))
        )
        (box :class "sysinfo":orientation "h" :spacing 30 (ram) (cpu) (disk))
        (box :class "sliders" :orientation "v" 
            (box :space-evenly false :class "music_slider"
                (button :class "music_icon" :onclick "scripts/volume music mute" {musicvolume == "0" ? "" :""} )
                (scale :min 0 :max 151 :width 420 :value musicvolume :onchange "scripts/volume music vol-change {}"))
            (box :space-evenly false :class "browser_slider"
                (button :class "browser_icon" :onclick "scripts/volume browser mute" {browservolume == 0 ? "" :""} )
                (scale :min 0 :max 151 :width 420 :value browservolume :onchange "scripts/volume browser vol-change {}"))
            (box :space-evenly false :class "head_slider"
                (button :class "head_icon" :onclick "scripts/volume head mute" {headvolume == 0 ? "" :""} )
                (scale :min 0 :max 151 :width 420 :value headvolume :onchange "scripts/volume head vol-change {}"))
            (box :space-evenly false :class "mon_slider"
                (button :class "mon_icon" :onclick "scripts/volume mon mute" {monvolume == 0 ? "" :""} )
                (scale :min 0 :max 151 :width 420 :value monvolume :onchange "scripts/volume mon vol-change {}"))
            (box :space-evenly false :class "mic_slider"
                (button :class "mic_icon" :onclick "scripts/volume mic mute" {micvolume == 0 ? "" :""} )
                (scale :min 0 :max 101 :width 420 :value micvolume :onchange "scripts/volume mic vol-change {}"))
        )
        (box :class "apps" :orientation "v" :space-evenly false :spacing 9
            (box :orientation "h" :space-evenly false :spacing 9
                (button :onclick "eww close board && floorp &" (image :path "images/firefox.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && spotify &" (image :path "images/spotify.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && alacritty --working-directory ~ &" (image :path "images/alacritty.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && thunar ~ &" (image :path "images/thunar.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && vscodium &" (image :path "images/vscodium.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && mousepad &" (image :path "images/mousepad.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && discord &" (image :path "images/discord.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && gimp &" (image :path "images/gimp.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && virtualbox &" (image :path "images/vbox.png" :image-width 45 :image-height 45))
            )
            (box :orientation "h" :space-evenly false :spacing 9
                (button :onclick "eww close board && floorp youtube.com &" (image :path "images/youtube.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && floorp github.com &" (image :path "images/github.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && floorp reddit.com &" (image :path "images/reddit.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && floorp x.com &" (image :path "images/x.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && floorp twitch.tv &" (image :path "images/twitch.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && floorp chat.openai.com &" (image :path "images/gpt.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && lutris &" (image :path "images/lutris.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && steam &" (image :path "images/steam.png" :image-width 45 :image-height 45))
                (button :onclick "eww close board && qutebrowser &" (image :path "images/qute.png" :image-width 45 :image-height 45))
            )
        )
        (box :orientation "h" :space-evenly false :halign "end"
            (box :class "weather-container" :orientation "v" :space-evenly "false"
                (label :class "weather-info" :text "${weatherStat}" :halign "start")
                (button :class "weather-temp" :halign "center" :onclick "floorp https://www.accuweather.com/en/bg/silistra/45981/weather-forecast/45981" "${weatherTemp}")
                (label :class "weather-icon" :style "color: ${weatherIconColor};" :text "${weatherIcon}" :halign "start")
                (label :class "weather-wind" :text "${weatherWind}" :halign "start")
            )
            (box :class "network" :orientation "v" :space-evenly "false"
                (box :orientation "v" :class "downspeedbox" :vexpand "true"
                    (downspeed)
                    (box :orientation "h" :halign "end"
                        (label :class "downSpeed-text" :text "${downSpeed}" :halign "end")
                        (label :class "downarrow" :text "" :halign "end")
                    )
                )
                (box :orientation "v" :class "upspeedbox" :vexpand "false"
                    (upspeed)
                    (box :orientation "h" :halign "end"
                        (label :class "upSpeed-text" :text "${upSpeed}" )
                        (label :class "uparrow" :text "" :halign "end")
                    )
                )
            )
        )
    )  
)


(defwidget cal [] (calendar :class "cal"))

                    ;================network================

(defwidget downspeed []  
    (box (graph :value {EWW_NET["eno1"].NET_DOWN} 
                :class "downspeed"
                :time-range "30s"               
                :max "28000000"
                :width 250
                :thickness "3")))

(defwidget upspeed []  
    (box (graph :value {EWW_NET["eno1"].NET_UP} 
                :class "upspeed"
                :time-range "30s" 
                :max "28000000"
                :width 250
                :thickness "3")))

                    ;================sysinfo================

(defwidget ram [] 
    (box (circular-progress :value {EWW_RAM.used_mem_perc}
                            :class "ram"
                            :thickness 12
                            :start-at 75
             (label :class "iconram" :text ""))))

(defwidget cpu []
    (box (circular-progress :value {EWW_CPU.avg}
                            :class "cpu"
                            :thickness 12
                            :start-at 75
            (label :class "iconcpu" :text ""))))

(defwidget disk []
    (box (circular-progress :value {EWW_DISK["/"].used_perc}
                            :class "disk"
                            :thickness 12
                            :start-at 75
            (label :class "icondisk" :text ""))))








(defwindow board
    :monitor 0 
    :windowtype "dock"
    :geometry (geometry :x "25px"
                        :y "25px"
                        :width "500px"
                        :height "1000px"
                        :anchor "top right")
    (board))
